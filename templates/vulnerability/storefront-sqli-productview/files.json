{
  "variables": {
    "flag_table_name": {"method": "random_alnum", "args": [12]}
  },

  "actions": [
    {
      "source_file": "productview_sqli_enable.txt",
      "target_file": "/var/www/html/show_product.php",
      "action_type": "REPLACE",
      "match_lines": "29-32"
    },

    {
      "source_text": "",
      "target_file": "/var/www/html/show_product.php",
      "action_type": "REPLACE",
      "match_lines": "3-7"
    },

    {
      "source_text": "$id = isset($_GET['productid']) ? $_GET['productid'] : 0;",
      "target_file": "/var/www/html/show_product.php",
      "action_type": "REPLACE",
      "match_regex": "\\$id = isset\\(\\$_GET\\['productid']\\) \\? \\(int\\)\\$_GET\\['productid'] : 0;"
    },

    {
      "source_code": "sqli_comment.py",
      "target_file": "/var/www/html/show_product.php",
      "action_type": "APPEND",
      "match_regex": "<body>"
    },

    {
      "source_text": "<!-- Moved information temporarily to table $$flag_table_name$$ -->",
      "target_file": "/var/www/html/admin_area.php",
      "action_type": "REPLACE",
      "match_regex": "<p>There's nothing here...</p>"
    },

    {
      "source_file": "patch.sql",
      "target_file": "/tmp/data.sql",
      "action_type": "REPLACE",
      "match_regex": "COMMIT;"
    }
  ]
}